{% set current = request.endpoint or "" %}
{% set username = session.get("username", "Admin") %}
{% set role = session.get("role", "admin") %}

<!-- Bootstrap & Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

<style>
  :root {
    --sea-blue: #0ea5e9;
    --dark-bg: #053047;
    --light-text: #e9eef6;
  }
  .admin-sidebar { width: 260px; background: var(--dark-bg); color: var(--light-text); }
  .admin-sidebar .nav-link { color: #c9d6e3; border-radius: .5rem; padding: .55rem .9rem; display: flex; align-items: center; gap: .6rem; }
  .admin-sidebar .nav-link.active, .admin-sidebar .nav-link:hover { background: var(--sea-blue); color: #fff; }
  .admin-avatar { width: 42px; height: 42px; border-radius: 50%; overflow: hidden; border: 2px solid var(--sea-blue); flex: 0 0 42px; }
  .admin-avatar img { width: 100%; height: 100%; object-fit: cover; display: block; }
  @media (min-width: 992px) { .content-with-sidebar { margin-left: 260px; } .sidebar-fixed { position: fixed; top: 0; bottom: 0; left: 0; } }
</style>

<!-- Minimal top navbar (mobile hamburger) -->
<nav class="navbar navbar-dark" style="background: var(--dark-bg);">
  <div class="container-fluid">
    <button class="navbar-toggler d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#adminDrawer" aria-controls="adminDrawer">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>
</nav>

<!-- Offcanvas (Mobile) -->
<div class="offcanvas offcanvas-start text-bg-dark" tabindex="-1" id="adminDrawer" style="width:260px;background: var(--dark-bg);">
  <div class="offcanvas-header">
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
  </div>

  <div class="offcanvas-body d-flex flex-column">
    <div class="d-flex align-items-center mb-3">
      <div class="admin-avatar me-2">
        <img src="https://res.cloudinary.com/dcmewvlyx/image/upload/v1754392905/Ngonu_Logo_xntvbm.jpg" alt="Admin Logo">
      </div>
      <div>
        <div class="fw-semibold">{{ username }}</div>
        <div class="text-white-50 text-capitalize small">{{ role }}</div>
      </div>
    </div>

    <hr class="border-secondary">

    <ul class="nav nav-pills flex-column mb-auto">
      <li class="nav-item">
        <a href="{{ url_for('admin_customers.view_customers') }}"
           class="nav-link {% if current == 'admin_customers.view_customers' %}active{% endif %}">
          <i class="bi bi-people-fill"></i> Customers
        </a>
      </li>
      <!-- ✅ Services link (MOBILE) -->
      <li class="nav-item">
        <a href="{{ url_for('admin_services.manage_services') }}"
           class="nav-link {% if current == 'admin_services.manage_services' %}active{% endif %}">
          <i class="bi bi-collection"></i> Services
        </a>
        
      </li>
      <li class="nav-item">
  <a href="{{ url_for('admin_orders.admin_view_orders') }}"
     class="nav-link {% if current == 'admin_orders.admin_view_orders' %}active{% endif %}">
    <i class="bi bi-bag-check-fill"></i> Orders
  </a>
</li>
<li class="nav-item">
  <a href="{{ url_for('admin_transactions.admin_view_transactions') }}"
     class="nav-link {% if current == 'admin_transactions.admin_view_transactions' %}active{% endif %}">
    <i class="bi bi-cash-stack"></i> Transactions
  </a>
</li>
 <li class="nav-item">
      <a href="{{ url_for('admin_referrals.admin_referrals') }}"
         class="nav-link {% if current == 'admin_referrals.view_referrals' %}active{% endif %}">
        <i class="bi bi-person-lines-fill"></i> Referrals
      </a>
    </li>
    <li class="nav-item">
  <a href="{{ url_for('admin_balance.view_balances') }}"
     class="nav-link {% if current == 'admin_balance.view_balances' %}active{% endif %}">
    <i class="bi bi-wallet2"></i> Balances
  </a>
</li>
<li class="nav-item">
  <a href="{{ url_for('admin_wassce_checker.admin_wassce_checker') }}"
     class="nav-link {% if current == 'admin_wassce_checker.admin_wassce_checker' %}active{% endif %}">
    <i class="bi bi-book"></i> WASSCE Checker
  </a>
</li>
<li class="nav-item">
    <a href="{{ url_for('admin_purchases.view_all_purchases') }}" class="nav-link {% if current == 'admin_purchases.view_all_purchases' %}active{% endif %}">
        <i class="bi bi-basket2"></i> All Purchases
    </a>
</li>
<li class="nav-item">
  <a href="{{ url_for('settings.manage_api') }}" class="nav-link {% if current == 'settings.manage_api' %}active{% endif %}">
    <i class="bi bi-gear"></i> API Settings
  </a>
</li>

    </ul>

    <div class="mt-auto">
      <hr class="border-secondary">
      <a href="{{ url_for('login.logout') }}" class="btn btn-outline-light w-100">
        <i class="bi bi-box-arrow-right"></i> Logout
      </a>
    </div>
  </div>
</div>

<!-- Fixed Sidebar (Desktop) -->
<aside class="admin-sidebar sidebar-fixed d-none d-lg-flex flex-column p-3">
  <div class="d-flex align-items-center mb-3">
    <div class="admin-avatar me-2">
      <img src="https://res.cloudinary.com/dcmewvlyx/image/upload/v1754392905/Ngonu_Logo_xntvbm.jpg" alt="Admin Logo">
    </div>
    <div>
      <div class="fw-semibold">{{ username }}</div>
      <div class="text-white-50 text-capitalize small">{{ role }}</div>
    </div>
  </div>

  <hr class="border-secondary">

  <ul class="nav nav-pills flex-column mb-auto">
    <li class="nav-item">
      <a href="{{ url_for('admin_customers.view_customers') }}"
         class="nav-link {% if current == 'admin_customers.view_customers' %}active{% endif %}">
        <i class="bi bi-people-fill"></i> Customers
      </a>
    </li>
    <!-- ✅ Services link (DESKTOP) -->
    <li class="nav-item">
      <a href="{{ url_for('admin_services.manage_services') }}"
         class="nav-link {% if current == 'admin_services.manage_services' %}active{% endif %}">
        <i class="bi bi-collection"></i> Services
      </a>
    </li>
    <li class="nav-item">
  <a href="{{ url_for('admin_orders.admin_view_orders') }}"
     class="nav-link {% if current == 'admin_orders.admin_view_orders' %}active{% endif %}">
    <i class="bi bi-bag-check-fill"></i> Orders
  </a>
</li>
<li class="nav-item">
  <a href="{{ url_for('admin_transactions.admin_view_transactions') }}"
     class="nav-link {% if current == 'admin_transactions.admin_view_transactions' %}active{% endif %}">
    <i class="bi bi-cash-stack"></i> Transactions
  </a>
</li>
 <li class="nav-item">
      <a href="{{ url_for('admin_referrals.admin_referrals') }}"
         class="nav-link {% if current == 'admin_referrals.view_referrals' %}active{% endif %}">
        <i class="bi bi-person-lines-fill"></i> Referrals
      </a>
    </li>
<li class="nav-item">
  <a href="{{ url_for('admin_balance.view_balances') }}"
     class="nav-link {% if current == 'admin_balance.view_balances' %}active{% endif %}">
    <i class="bi bi-wallet2"></i> Balances
  </a>
</li>
<li class="nav-item">
  <a href="{{ url_for('admin_wassce_checker.admin_wassce_checker') }}"
     class="nav-link {% if current == 'admin_wassce_checker.admin_wassce_checker' %}active{% endif %}">
    <i class="bi bi-book"></i> WASSCE Checker
  </a>
</li>
<li class="nav-item">
    <a href="{{ url_for('admin_purchases.view_all_purchases') }}" class="nav-link {% if current == 'admin_purchases.view_all_purchases' %}active{% endif %}">
        <i class="bi bi-basket2"></i> All Purchases
    </a>
</li>
<li class="nav-item">
  <a href="{{ url_for('settings.manage_api') }}" class="nav-link {% if current == 'settings.manage_api' %}active{% endif %}">
    <i class="bi bi-gear"></i> API Settings
  </a>
</li>

  </ul>

  <div class="mt-auto">
    <a href="{{ url_for('login.logout') }}" class="btn btn-outline-light w-100 mt-3">
      <i class="bi bi-box-arrow-right"></i> Logout
    </a>
  </div>
</aside>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
